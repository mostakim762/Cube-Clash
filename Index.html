<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>2048 – Simple HTML Version</title>
<style>
  :root{
    --bg:#faf8ef; --board:#bbada0; --empty:#cdc1b4;
    --txt:#776e65; --white:#fff;
    --btn-blue:#2ea7ff; --btn-red:#ff5959; --btn-gold:#f4a300;
    --btn-green:#1bc5a3; --btn-purple:#7a4cff;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:var(--bg); color:var(--txt);
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans Bengali", "Noto Sans", sans-serif;
    display:flex; justify-content:center; align-items:flex-start; min-height:100dvh; padding:24px;
  }
  .app{width:min(520px, 92vw)}
  h1{margin:0 0 8px 0; letter-spacing:1px}
  .sub{opacity:.7; margin-bottom:14px}
  .top{
    display:grid; grid-template-columns: 1fr auto; gap:12px; align-items:center;
  }
  .scores{display:flex; gap:10px}
  .card{
    background:#edc22e; color:#fff; border-radius:12px; padding:10px 14px; text-align:center; min-width:90px;
  }
  .card small{display:block; opacity:.85; font-weight:700; font-size:12px; letter-spacing:.5px}
  .card b{font-size:22px}

  .buttons{
    display:grid;
    grid-template-columns: repeat(2, 1fr);
    gap:12px;
    margin:16px 0 10px;
  }
  .buttons .btn.wide{grid-column: span 2;}
  .btn{
    appearance:none; border:0; color:#fff; font-weight:800; letter-spacing:.5px;
    padding:14px 18px; border-radius:999px; cursor:pointer; box-shadow:0 8px 16px rgba(0,0,0,.08);
    transition: transform .05s ease, filter .2s ease, opacity .2s;
    font-size:15px;
  }
  .btn:active{transform:translateY(1px); filter:brightness(.96)}
  .btn.blue{background:var(--btn-blue)}
  .btn.red{background:var(--btn-red)}
  .btn.gold{background:var(--btn-gold)}
  .btn.green{background:var(--btn-green)}
  .btn.purple{background:var(--btn-purple)}

  .board-wrap{position:relative; margin-top:10px}
  .board{
    position:relative;
    width: min(520px, 92vw);
    aspect-ratio: 1 / 1;
    background:var(--board);
    border-radius:12px; padding:10px;
    display:grid; grid-template-columns: repeat(4, 1fr); gap:10px;
  }
  .cell{
    background:var(--empty); border-radius:8px; width:100%; height:100%;
  }
  /* tile layer */
  .tiles{
    position:absolute; inset:10px; display:grid; grid-template-columns: repeat(4, 1fr); gap:10px;
    pointer-events:none; /* tiles don't catch clicks */
  }
  .tile{
    display:flex; align-items:center; justify-content:center;
    border-radius:8px; font-weight:900; font-size:clamp(20px, 6vw, 32px);
    color:var(--txt);
    width:100%; height:100%;
    animation: pop .12s ease;
  }
  @keyframes pop{from{transform:scale(.95); opacity:.7} to{transform:scale(1); opacity:1}}

  /* colors per value */
  .v2{background:#eee4da}
  .v4{background:#ede0c8}
  .v8{background:#f2b179; color:#fff}
  .v16{background:#f59563; color:#fff}
  .v32{background:#f67c5f; color:#fff}
  .v64{background:#f65e3b; color:#fff}
  .v128{background:#edcf72; color:#fff}
  .v256{background:#edcc61; color:#fff}
  .v512{background:#edc850; color:#fff}
  .v1024{background:#edc53f; color:#fff; font-size:clamp(18px, 5vw, 28px)}
  .v2048{background:#edc22e; color:#fff; font-size:clamp(18px, 5vw, 28px)}

  .hint{margin-top:8px; font-size:14px; opacity:.7}
  .banner{
    position:absolute; inset:0; display:flex; align-items:center; justify-content:center; z-index:5;
    background:rgba(255,255,255,.85); color:#333; text-align:center; padding:24px; border-radius:12px; backdrop-filter: blur(2px);
    font-weight:800; font-size:clamp(20px, 5vw, 28px); letter-spacing:.5px; display:none;
  }
  .banner.show{display:flex}
  .modal-backdrop{
    position:fixed; inset:0; background:rgba(0,0,0,.35); display:none; align-items:center; justify-content:center; z-index:20;
  }
  .modal{background:#fff; width:min(480px, 92vw); border-radius:14px; padding:18px}
  .modal h3{margin:0 0 8px 0}
  .modal p{margin:6px 0}
  .modal .row{display:flex; gap:10px; margin-top:12px; justify-content:flex-end}
  .modal .row .btn{padding:10px 14px; font-size:14px}
  .ad-timer{font-weight:800}
</style>
</head>
<body>
  <div class="app">
    <div class="top">
      <div>
        <h1>2048</h1>
        <div class="sub">টাইলগুলো যুক্ত করে 2048 বানান। (Arrow keys / swipe)</div>
      </div>
      <div class="scores">
        <div class="card"><small>SCORE</small><b id="score">0</b></div>
        <div class="card"><small>BEST</small><b id="best">0</b></div>
      </div>
    </div>

    <!-- Buttons (like your screenshot) -->
    <div class="buttons">
      <button class="btn blue"   id="btn-start">START GAME</button>
      <button class="btn red"    id="btn-new">NEW GAME</button>
      <button class="btn gold wide"   id="btn-ad">WATCH AD</button>
      <button class="btn green"  id="btn-profile">PROFILE</button>
      <button class="btn purple" id="btn-withdraw">WITHDRAW</button>
    </div>

    <div class="board-wrap">
      <div id="banner" class="banner">Game Over</div>
      <div class="board" aria-label="2048 board">
        <!-- background cells -->
        <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
        <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
        <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
        <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
      </div>
      <!-- dynamic tiles layer -->
      <div class="tiles" id="tiles"></div>
    </div>
    <div class="hint">নতুন টাইল আনতে <b>NEW GAME</b> চাপুন। মোবাইলে বোর্ডে সোয়াইপ করুন।</div>
  </div>

  <!-- Simple modals -->
  <div class="modal-backdrop" id="modal">
    <div class="modal">
      <h3 id="modal-title">Title</h3>
      <div id="modal-body"></div>
      <div class="row">
        <button class="btn purple" id="modal-close">Close</button>
      </div>
    </div>
  </div>

<script>
(() => {
  const size = 4;
  let board = emptyBoard();
  let score = 0;
  let started = false;

  const tilesEl = document.getElementById('tiles');
  const scoreEl = document.getElementById('score');
  const bestEl = document.getElementById('best');
  const bannerEl = document.getElementById('banner');

  bestEl.textContent = localStorage.getItem('best2048') || 0;

  function emptyBoard(){
    return Array.from({length:size}, ()=>Array(size).fill(0));
  }

  function randomEmptyCell(){
    const empty = [];
    for(let r=0;r<size;r++){
      for(let c=0;c<size;c++){
        if(board[r][c]===0) empty.push([r,c]);
      }
    }
    if(empty.length===0) return null;
    return empty[Math.floor(Math.random()*empty.length)];
  }

  function addRandomTile(){
    const cell = randomEmptyCell();
    if(!cell) return false;
    const [r,c] = cell;
    board[r][c] = Math.random() < 0.9 ? 2 : 4;
    return true;
  }

  function reset(){
    board = emptyBoard();
    score = 0;
    started = true;
    bannerEl.classList.remove('show');
    addRandomTile(); addRandomTile();
    draw();
  }

  function draw(){
    // clear
    tilesEl.innerHTML = '';
    for(let r=0;r<size;r++){
      for(let c=0;c<size;c++){
        const v = board[r][c];
        const tile = document.createElement('div');
        tile.className = 'tile';
        if(v>0){
          tile.classList.add('v'+v);
          tile.textContent = v;
        } else {
          tile.style.visibility = 'hidden';
        }
        tile.style.gridRowStart = r+1;
        tile.style.gridColumnStart = c+1;
        tilesEl.appendChild(tile);
      }
    }
    scoreEl.textContent = score;
    const best = Math.max(Number(localStorage.getItem('best2048')||0), score);
    localStorage.setItem('best2048', best);
    bestEl.textContent = best;
  }

  function canMove(){
    // any empty?
    for(let r=0;r<size;r++){
      for(let c=0;c<size;c++){
        if(board[r][c]===0) return true;
      }
    }
    // any equal adjacent?
    for(let r=0;r<size;r++){
      for(let c=0;c<size;c++){
        const v = board[r][c];
        if(r+1<size && board[r+1][c]===v) return true;
        if(c+1<size && board[r][c+1]===v) return true;
      }
    }
    return false;
  }

  function slide(row){
    // remove zeros
    row = row.filter(v=>v!==0);
    // merge
    for(let i=0;i<row.length-1;i++){
      if(row[i]===row[i+1]){
        row[i]*=2;
        score += row[i];
        row[i+1]=0;
        i++;
      }
    }
    // remove zeros again
    row = row.filter(v=>v!==0);
    // pad with zeros
    while(row.length<size) row.push(0);
    return row;
  }

  function rotateClockwise(mat){
    const n = mat.length;
    const res = Array.from({length:n},()=>Array(n).fill(0));
    for(let r=0;r<n;r++){
      for(let c=0;c<n;c++){
        res[c][n-1-r] = mat[r][c];
      }
    }
    return res;
  }

  function move(dir){
    // dir: 'left','right','up','down'
    let moved = false;
    let old = JSON.stringify(board);

    if(dir==='left'){
      for(let r=0;r<size;r++){
        board[r] = slide(board[r]);
      }
    } else if(dir==='right'){
      for(let r=0;r<size;r++){
        board[r] = slide(board[r].slice().reverse()).reverse();
      }
    } else if(dir==='up'){
      // rotate left -> slide -> rotate right
      board = rotateClockwise(board); // 90
      board = rotateClockwise(board); // 180
      board = rotateClockwise(board); // 270
      for(let r=0;r<size;r++) board[r] = slide(board[r]);
      board = rotateClockwise(board); // back to normal
    } else if(dir==='down'){
      board = rotateClockwise(board); // 90
      for(let r=0;r<size;r++) board[r] = slide(board[r]);
      board = rotateClockwise(board); // 180
      board = rotateClockwise(board); // 270
      board = rotateClockwise(board); // 360 -> normal
    }

    moved = (JSON.stringify(board) !== old);
    if(moved){
      addRandomTile();
      draw();
      if(!canMove()){
        bannerEl.textContent = 'Game Over';
        bannerEl.classList.add('show');
        started = false;
      } else if (has2048()){
        bannerEl.textContent = 'You made 2048! 🎉';
        bannerEl.classList.add('show');
      }
    }
  }

  function has2048(){
    for(let r=0;r<size;r++){
      for(let c=0;c<size;c++){
        if(board[r][c]===2048) return true;
      }
    }
    return false;
  }

  // Controls
  window.addEventListener('keydown', e=>{
    if(!started) return;
    if(['ArrowLeft','ArrowRight','ArrowUp','ArrowDown'].includes(e.key)){
      e.preventDefault();
      bannerEl.classList.remove('show');
      const map = {
        ArrowLeft:'left', ArrowRight:'right', ArrowUp:'up', ArrowDown:'down'
      }
      move(map[e.key]);
    }
  });

  // touch controls
  let touchStart=null;
  const boardWrap = document.querySelector('.board-wrap');
  boardWrap.addEventListener('touchstart', e=>{
    if(e.touches.length===1){
      const t=e.touches[0];
      touchStart={x:t.clientX,y:t.clientY};
    }
  }, {passive:true});
  boardWrap.addEventListener('touchend', e=>{
    if(!touchStart || !started) return;
    const t=e.changedTouches[0];
    const dx=t.clientX-touchStart.x, dy=t.clientY-touchStart.y;
    const absX=Math.abs(dx), absY=Math.abs(dy);
    if(Math.max(absX,absY) < 24) return; // small move ignore
    bannerEl.classList.remove('show');
    if(absX>absY) move(dx>0?'right':'left');
    else move(dy>0?'down':'up');
    touchStart=null;
  }, {passive:true});

  // Buttons
  document.getElementById('btn-new').addEventListener('click', reset);
  document.getElementById('btn-start').addEventListener('click', ()=>{
    if(!started){
      reset();
    } else {
      // just hide banner if any
      bannerEl.classList.remove('show');
    }
  });

  // Fake watch ad: 5s countdown then +25 score bonus
  document.getElementById('btn-ad').addEventListener('click', ()=>{
    openModal('WATCH AD', `
      <p>ডেমো বিজ্ঞাপন চলছে… <span class="ad-timer" id="ad-timer">5</span>s</p>
      <p>শেষ হলে <b>+25</b> বোনাস স্কোর পাবেন।</p>
    `);
    let t=5;
    const timerEl = () => document.getElementById('ad-timer');
    const iv = setInterval(()=>{
      t--; if(timerEl()) timerEl().textContent = t;
      if(t<=0){
        clearInterval(iv);
        score += 25;
        draw();
        setTimeout(closeModal, 400);
      }
    }, 1000);
  });

  document.getElementById('btn-profile').addEventListener('click', ()=>{
    const best = localStorage.getItem('best2048') || 0;
    openModal('PROFILE', `
      <p><b>Player:</b> Guest</p>
      <p><b>Best Score:</b> ${best}</p>
      <p><small>ডেমো প্রোফাইল—ইচ্ছা করলে এখানে আপনার ইউজার সিস্টেম যুক্ত করতে পারবেন।</small></p>
    `);
  });

  document.getElementById('btn-withdraw').addEventListener('click', ()=>{
    openModal('WITHDRAW', `
      <p>এটি ডেমো স্ক্রিন। এখানে আপনার গেমের কয়েন/পয়েন্ট সিস্টেম থাকলে উত্তোলনের UI বসাতে পারবেন।</p>
      <p><small>নিরাপত্তার জন্য বাস্তবে সার্ভার-সাইড ভেরিফিকেশন ব্যবহার করুন।</small></p>
    `);
  });

  // modal helpers
  const modal = document.getElementById('modal');
  const modalTitle = document.getElementById('modal-title');
  const modalBody = document.getElementById('modal-body');
  const closeBtn = document.getElementById('modal-close');

  modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });
  closeBtn.addEventListener('click', closeModal);

  function openModal(title, html){
    modalTitle.textContent = title;
    modalBody.innerHTML = html;
    modal.style.display='flex';
  }
  function closeModal(){ modal.style.display='none'; }

  // start with a ready board (user presses START/NEW)
  draw();
})();
</script>
</body>
</html>